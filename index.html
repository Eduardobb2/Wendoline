<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>¿Quieres ser mi novia?</title>
    <style>
        body {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background: linear-gradient(to bottom right, #ffccd5, #ffe6f0);
            font-family: 'Comic Sans MS', cursive, sans-serif;
            text-align: center;
            overflow: hidden;
        }
        img {
            width: 200px;
            height: 200px;
            border-radius: 50%;
            border: 5px solid #e91e63;
            margin-bottom: 20px;
            object-fit: cover;
        }
        h1 {
            color: #e91e63;
            font-size: 2.5em;
        }
        button {
            margin: 10px;
            padding: 15px 30px;
            font-size: 18px;
            border: none;
            border-radius: 10px;
            color: white;
            background-color: #e91e63;
            cursor: pointer;
            transition: 0.3s;
        }
        button:hover {
            background-color: #ad1457;
            transform: scale(1.1);
        }
        #noButton {
            position: absolute;
        }
        #confetti-canvas {
            pointer-events: none;
            position: fixed;
            top: 0; left: 0; width: 100vw; height: 100vh;
            z-index: 9999;
        }
        #ring {
            display: none;
            position: fixed;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%) scale(0.5);
            z-index: 10000;
            width: 120px;
            height: 120px;
            animation: ring-pop 1s ease;
        }
        @keyframes ring-pop {
            0% { transform: translate(-50%, -50%) scale(0); opacity: 0; }
            60% { transform: translate(-50%, -50%) scale(1.2); opacity: 1; }
            80% { transform: translate(-50%, -50%) scale(0.9); }
            100% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
        }
    </style>
</head>
<body>
    <!-- Foto de perrito, libre de derechos, ejemplo: unsplash -->
    <img src="https://images.unsplash.com/photo-1518717758536-85ae29035b6d?auto=format&fit=facearea&w=400&h=400&facepad=3&q=80" alt="Perrito tierno" />
    <h1>💖 ¿Quieres ser mi novia? 💖</h1>
    <button onclick="respuesta('Sí')">Sí 🥰</button>
    <button id="noButton" onmouseover="moverNo()" onclick="respuesta('No')">No 😢</button>

    <!-- Audio compatible y sin autoplay -->
    <audio id="love-audio" preload="auto" loop>
        <source src="https://cdn.pixabay.com/audio/2022/10/16/audio_12c8c1e4a2.mp3" type="audio/mpeg">
        Tu navegador no soporta audio.
    </audio>

    <!-- Canvas para confeti -->
    <canvas id="confetti-canvas"></canvas>

    <!-- SVG para anillo -->
    <div id="ring">
        <svg viewBox="0 0 120 120">
            <!-- Aro -->
            <ellipse cx="60" cy="80" rx="40" ry="35" fill="gold" stroke="#bfa700" stroke-width="8"/>
            <!-- Diamante -->
            <polygon points="60,35 85,60 60,20 35,60" fill="#b7f9ff" stroke="#5ed4f6" stroke-width="3"/>
            <ellipse cx="60" cy="45" rx="12" ry="7" fill="#d8faff" stroke="#a4e7f6" stroke-width="2"/>
        </svg>
    </div>

    <script>
        // Audio para Safari y otros navegadores (solo tras interacción)
        const audio = document.getElementById('love-audio');
        let hasPlayed = false;

        function playAudio() {
            if (!hasPlayed) {
                audio.play().catch(()=>{}); // Safari requiere interacción
                hasPlayed = true;
            }
        }

        // Confeti básico
        const confettiColors = ['#e91e63', '#f50057', '#ffeb3b', '#00bcd4', '#8bc34a', '#fff', '#f8bbd0'];
        function throwConfetti() {
            const canvas = document.getElementById('confetti-canvas');
            const ctx = canvas.getContext('2d');
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            const confettis = [];
            for (let i = 0; i < 150; i++) {
                confettis.push({
                    x: Math.random() * canvas.width,
                    y: Math.random() * -canvas.height,
                    r: 6 + Math.random() * 10,
                    d: Math.random() * 50 + 30,
                    color: confettiColors[Math.floor(Math.random()*confettiColors.length)],
                    tilt: Math.random() * 10 - 5,
                    tiltAngle: Math.random() * Math.PI,
                    tiltAngleIncremental: (Math.random() * 0.07) + 0.05,
                    gravity: Math.random() * 2 + 2,
                });
            }
            let angle = 0;
            function draw() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                angle += 0.01;
                for (let i = 0; i < confettis.length; i++) {
                    let c = confettis[i];
                    c.y += c.gravity;
                    c.tiltAngle += c.tiltAngleIncremental;
                    c.tilt = Math.sin(c.tiltAngle) * 15;
                    ctx.beginPath();
                    ctx.ellipse(
                        c.x + c.tilt,
                        c.y,
                        c.r,
                        c.r/2,
                        angle,
                        0,
                        2 * Math.PI
                    );
                    ctx.fillStyle = c.color;
                    ctx.fill();
                    // reinicia si sale de pantalla
                    if (c.y > canvas.height + 20) {
                        c.x = Math.random() * canvas.width;
                        c.y = -20;
                    }
                }
                requestAnimationFrame(draw);
            }
            draw();
            // Detener confeti después de 3 segundos
            setTimeout(() => {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                canvas.width = 0; canvas.height = 0;
            }, 3000);
        }

        function respuesta(opcion) {
            playAudio();
            if (opcion === "Sí") {
                alert("🥳 Muy bien chiquita bebe ❤️ Te amo mucho 💖");
                mostrarAnillo();
                throwConfetti();
            } else {
                alert("😢 Bueno... 💔");
            }
        }

        function mostrarAnillo() {
            const ring = document.getElementById('ring');
            ring.style.display = 'block';
            ring.style.animation = 'ring-pop 1s ease';
            setTimeout(() => {
                ring.style.display = 'none';
            }, 2500);
        }

        // Mejorada para Safari: no sale de pantalla
        function moverNo() {
            playAudio();
            const noBtn = document.getElementById('noButton');
            const btnWidth = noBtn.offsetWidth;
            const btnHeight = noBtn.offsetHeight;
            const maxLeft = window.innerWidth - btnWidth - 10;
            const maxTop = window.innerHeight - btnHeight - 10;
            noBtn.style.left = Math.random() * maxLeft + 'px';
            noBtn.style.top = Math.random() * maxTop + 'px';
        }

        // Ajusta el canvas de confeti si cambia el tamaño de la ventana
        window.addEventListener('resize', () => {
            const canvas = document.getElementById('confetti-canvas');
            if (canvas.width > 0) {
                canvas.width = window.innerWidth;
                canvas.height = window.innerHeight;
            }
        });

        // Por si el usuario hace hover antes de presionar cualquier botón, asegura play en "No"
        document.getElementById('noButton').addEventListener('mouseover', playAudio);
    </script>
</body>
</html>
